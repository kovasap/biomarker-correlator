{"version":3,"sources":["app/ui.cljs"],"mappings":"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","names":["app.ui/px-per-character","app.ui/get-rough-px-width","string","cljs.core/count","app.ui/make-datagrid-column","k","lines","clojure.string.split","cljs.core/name","reagent.core.as_element","cljs.core.into","cljs.core.concat","cljs.core.interleave","cljs.core.repeat","cljs.core.apply","cljs.core/max","cljs.core.map","var_args","args__4870__auto__","len__4864__auto__","i__4865__auto__","argseq__4871__auto__","cljs.core/IndexedSeq","app.ui/maps-to-datagrid","p__69877","map__69878","cljs.core/--destructure-map","cljs.core.get","seq69875","G__69876","cljs.core/first","cljs.core/next","self__4851__auto__","maps","custom-make-datagrid-column","_","sorted-rows","reagent.core.atom","sort-columns","js/shadow.js.shim.module$react_data_grid.default","cljs.core/clj->js","p1__69872#","cljs.core.merge","cljs.core/keys","cljs.core/deref","newSortColumns","map__69890","columnKey","direction","cljs.core.js__GT_clj","p1__69874#","cljs.core.swap_BANG_","cljs.core.sort","m1","m2","v1","v2","cljs.core._EQ_","app.csv/download-as-csv","app.ui/value-to-str","value","cljs.core/map?","app.ui/map-to-sorted-pairs","m","cljs.core.sort_by","pair","cljs.core/seq","app.ui/maps-to-html","sorted-pairs","iter__4652__auto__","s__69906","cljs.core/LazySeq","temp__5753__auto__","cljs.core/chunked-seq?","c__4650__auto__","size__4651__auto__","b__69908","cljs.core/chunk-buffer","i__69907","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__69905","cljs.core/chunk-rest","cljs.core/cons","cljs.core/rest","s__69914","b__69916","i__69915","iter__69913","pairs","s__69926","b__69928","i__69927","iter__69925","s__69946","b__69948","i__69947","iter__69945","r","cljs.core/peek","app.ui/hideable","hidden","component","cljs.core/reset!","cljs.core/not","app.ui/hover-to-render","hoverable","hidable","app.ui/cell-data","row","cell","map__69973","path","expr","or__4253__auto__","and__4251__auto__","cljs.core.get_in","app.ui/cell-fn","render-info","row-num","col-num","map__69979","format","attrs","cljs.core/identity","data","content","app.ui/compare-vals","x","y","cljs.core/vector?","p1__69991#","p2__69990#","cljs.core.reduce","cljs.core/compare","cljs.core/second","cljs.core.not_EQ_","cljs.core/reduced","cljs.core/vector","cljs.core/boolean?","app.ui/sort-fn","rows","column-model","sorting","row-x","row-y","sort","column","G__70007","cell-x","cell-y","compared","app.ui/get-column-model","flattened-data","s__70011","b__70013","i__70012","iter__70010","app.ui/reagent-table","data-atom","reagent-table.core/reagent-table","cljs.core/chunk-first"],"sourcesContent":["(ns app.ui\n  (:require\n    [app.specs :as specs]\n    [reagent-table.core :as rt]\n    [reagent.core :as r]\n    [\"react-data-grid\" :default DataGrid]\n    [app.csv :as csv]\n    [clojure.string :as st]))\n\n\n(def px-per-character 13)\n(defn get-rough-px-width\n  \"Gives a rough estimate for the pixel width of a string.\"\n  [string]\n  (* px-per-character (count string)))\n\n(defn make-datagrid-column\n  \"Generates a react-data-grid column \n  https://github.com/adazzle/react-data-grid/blob/929911c506919e96bd12e48ea5de68ec9511ca10/src/types.ts#L7\n  \n  '--' substrings in the input key are converted to newlines.\"\n  [k]\n  (let [lines (st/split (name k) #\"\\-\\-\")]\n    {:key k\n     :name (r/as-element\n             (into [] (concat\n                        [:div {:style {:line-height \"20px\"}}]\n                        (interleave lines (repeat [:br])))))\n     :sortable true\n     :width (apply max (map get-rough-px-width lines))})) \n\n(defn maps-to-datagrid\n  [maps & {:keys [custom-make-datagrid-column]\n           :or {custom-make-datagrid-column (fn [_] {})}}]\n  (let [sorted-rows (r/atom maps)\n        sort-columns (r/atom [{:columnKey \"input\" :direction \"ASC\"}])]\n    [:div\n      [:> DataGrid\n       {:columns (clj->js (map #(merge (make-datagrid-column %)\n                                       (custom-make-datagrid-column %))\n                               (keys (first maps))))\n        ; This in combination with [role=columndheader] in public/css/site.css\n        ; allows for multiline column headers.\n        :headerRowHeight 60\n        :defaultColumnOptions #js {:sortable true\n                                   :resizable true}\n        ; See\n        ; https://github.com/adazzle/react-data-grid/blob/b7ad586498ab8a6ed3235ccfd93d3d490b24f4cc/website/demos/CommonFeatures.tsx#L330\n        ; for how to make column sorting work. See also\n        ; https://github.com/reagent-project/reagent/issues/545\n        :sortColumns (clj->js @sort-columns)\n        :onSortColumnsChange\n        (fn [newSortColumns]\n          (let [{columnKey :columnKey\n                 direction :direction} (first (js->clj newSortColumns\n                                                       :keywordize-keys true))]\n            (swap! sorted-rows\n                   #(sort (fn [m1 m2]\n                            (let [v1 (get columnKey m1)\n                                  v2 (get columnKey m2)]\n                              (if (= direction \"ASC\")\n                                (< v1 v2)\n                                (> v1 v2))))\n                          %))))\n        :rows (clj->js @sorted-rows)}]\n      [:button {:on-click #(csv/download-as-csv maps \"data.csv\")}\n       \"Download as CSV\"]]))\n\n(maps-to-datagrid [{:test \"v1\" :test2 \"v2\"}])\n\n\n(defn value-to-str\n  \"Converts a given value into something displayable by an html tabl.\"\n  [value]\n  (cond\n    (map? value) \"{...}\"\n    :else value))\n\n; (value-to-str {:test \"map\"})\n\n; Beware sorting maps directly - it's been unreliable.  It's better to convert\n; to lists of 2-vectors and sort those.\n(defn map-to-sorted-pairs [m]\n  (sort-by (fn [pair]\n             (let [k (first pair)]\n               ; Capital letters get sorted before lowercase!\n               (if (= k :input) \"AAAAA\" (name k))))\n           (seq m)))\n\n(defn maps-to-html\n  \"Converts collection of maps like\n  [{:col1 val1 :col2 val2} {:col1 val3 :col2 val4}]\n  to an HTML table.\n  \n  See https://stackoverflow.com/a/33458370 for ^{:key} map explanation.\n  \"\n  {:malli/schema [:=> [:cat [:sequential :map]]\n                  specs/Hiccup]}\n  [maps]\n  (let [sorted-pairs (map map-to-sorted-pairs maps)]\n    [:table\n     (into [:tbody\n            (into [:tr] (for [k (map first (first sorted-pairs))]\n                          [:th k]))]\n           (for [pairs sorted-pairs]\n             (into [:tr] (for [r (map peek pairs)]\n                           [:td (value-to-str r)]))))]))\n\n(defn hideable\n  \"Adds a clickable hide button to the component.\n\n  I would use a details/summary html element, but they don't seem to play\n  nicely with react/reagent :(.\n  \n  Can be used like this:\n  [hidable component-to-hide]\"\n  [_]\n  (let [hidden (r/atom true)]\n    (fn [component]\n      [:div\n        [:button {:on-click #(reset! hidden (not @hidden))}\n         \"Click to hide/show\"]\n        [:div {:style {:display (if @hidden \"none\" \"block\")}}\n         component]])))\n\n\n(defn hover-to-render\n  \"Wraps a component in a function that only shows and renders it when an\n  element is hovered.\n\n  Original inspiration:\n  https://www.reddit.com/r/Clojure/comments/sihk4b/comment/hv8xrh6/\n  \"\n  [_]\n  (let [hidden (r/atom true)]\n    (fn [hoverable hidable]\n      [:div\n        [:div {:on-mouse-over #(reset! hidden false)\n               :on-mouse-out #(reset! hidden true)}\n         hoverable]\n        (if @hidden\n          nil\n          [:div {:style {:position \"absolute\" :z-index 100}}\n           hidable])])))\n\n\n; --- Reagent Table Logic ---------------------------\n; See https://github.com/Frozenlock/reagent-table/blob/master/dev/reagent_table/dev.cljs\n\n(defn- cell-data\n  \"Resolve the data within a row for a specific column\"\n  [row cell]\n  (let [{:keys [path expr]} cell]\n    (or (and path\n             (get-in row path))\n        (and expr\n             (expr row)))))\n\n(defn- cell-fn\n  \"Return the cell hiccup form for rendering.\n   - render-info the specific column from :column-model\n   - row the current row\n   - row-num the row number\n   - col-num the column number in model coordinates\"\n  [render-info row row-num col-num]\n  (let [{:keys [format attrs]\n         :or   {format identity\n                attrs (fn [_] {})}} render-info\n        data    (cell-data row render-info)\n        content (format data)\n        attrs   (attrs data)]\n    [:span\n     attrs\n     content]))\n\n(defn compare-vals\n  \"A comparator that works for the various types found in table structures.\n  This is a limited implementation that expects the arguments to be of\n  the same type. The :else case is to call compare, which will throw\n  if the arguments are not comparable to each other or give undefined\n  results otherwise.\n  Both arguments can be a vector, in which case they must be of equal\n  length and each element is compared in turn.\"\n  [x y]\n  (cond\n    (and (vector? x)\n         (vector? y)\n         (= (count x) (count y)))\n    (reduce #(let [r (compare (first %2) (second %2))]\n               (if (not= r 0)\n                 (reduced r)\n                 r))\n            0\n            (map vector x y))\n\n    (or (and (number? x) (number? y))\n        (and (string? x) (string? y))\n        (and (boolean? x) (boolean? y)))\n    (compare x y)\n\n    :else ;; hope for the best... are there any other possiblities?\n    (compare x y)))\n\n(defn- sort-fn\n  \"Generic sort function for tabular data. Sort rows using data resolved from\n  the specified columns in the column model.\"\n  [rows column-model sorting]\n  (sort (fn [row-x row-y]\n          (reduce\n            (fn [_ sort]\n              (let [column (column-model (first sort))\n                    direction (second sort)\n                    cell-x (cell-data row-x column)\n                    cell-y (cell-data row-y column)\n                    compared (if (= direction :asc)\n                               (compare-vals cell-x cell-y)\n                               (compare-vals cell-y cell-x))]\n                (when-not (zero? compared)\n                  (reduced compared))))\n                \n            0\n            sorting))\n        rows))\n\n(defn- get-column-model\n  [flattened-data]\n  (into [] (for [k (keys (first flattened-data))]\n             {:path [k] :header (name k) :key k})))\n\n(defn reagent-table [data-atom]\n  [rt/reagent-table\n   data-atom\n   {:column-model (get-column-model @data-atom)\n    :render-cell cell-fn\n    :sort sort-fn}])\n"]}