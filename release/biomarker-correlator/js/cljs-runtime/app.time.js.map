{"version":3,"sources":["app/time.cljs"],"mappings":";AAUA,sBAAA,tBAAMA,oDACHC;AADH,AAEE,IAAMC,QAAM,oFAAA,pFAACC,mDAAS,AAACC,oBAAQH;AAA/B,AACE,GAAI,GAAK,6CAAA,7CAACI,iDAAI,AAACC,gBAAMJ;AAArB;;AAEE,IAAAK,aAAuBL;YAAvB,AAAAM,4CAAAD,WAAA,IAAA,nEAAOE;UAAP,AAAAD,4CAAAD,WAAA,IAAA,jEAAaG;WAAb,AAAAF,4CAAAD,WAAA,IAAA,lEAAiBI;AAAjB,AAAA,kDAAA,sEAAA,kEAAA,hFACU,SAAA,RAAKF,mEACN,OAAA,NAAKC,+DACL,CAAK,iBAAAE,WAAM,AAACN,gBAAMK;AAAb,AAAA,QAAAC;KAAA;AACK,QAAA,iDAAUD;;;KADf;AAEKA;;;;AAFL;;;OAAL;;;AAKf,4BAAA,oCAAAE,hEAAMI;AAAN,AAAA,IAAAH,aAAAD;IAAAC,iBAAA,AAAAC,4BAAAD;YAAA,AAAAE,4CAAAF,eAAA,nEACWL;WADX,AAAAO,4CAAAF,eAAA,lEACiBI;WADjB,AAAAF,4CAAAF,eAAA,lEACsBH;AADtB,AAEE,OAACQ,yBAAQ,AAACC,uDAAUT,KAAKF,MAAMS;;AAEjC,AAAAG,yBAAA,AAAA,oEAAA,AAAA,iFAAcC;AACd,gBAAA,hBAAKC;AAEL,AAAAF,yBAAA,AAAA,8EAAA,AAAA,uPAAmB,AAAAG,8BAAA,AAAA,6OAAA,qIAAA,lDAAOC,qBAAKC;AAC/B,qBAAA,mFAAA,mDAAA,oDAAA,mFAAA,iDAAA,nVAAKC;AAIL,AAAAN,yBAAA,AAAA,6EAAA,AAAA,2mBACE,wDAAA,6EAAA,2CAAA,6EAAA,2EAAA,xUAACO,wOAA4BH,2EACDA,yEACAA;AAE9B,AAAA,AAAAJ,yBAAA,AAAA,+FAAA,AAAA,sgBAAA,AAAAQ,2BAAA,AAAAC,wDAAA,AAAA,wOAAA,AAAAC,yBAAA,mFAAA,uEAAA,mFAAA,4EAAA,AAAA,gKAAA,KAAA,MAAA,AAAA,wOAAA,AAAAD,wDAAA,AAAA,6EAAA,6EAAA,KAAA,MAAA,AAAA,6EAAA,KAAA,AAAA,KAAA;;AAAA;;;;;;4BAAA,5BAAOG,gEAIJC;AAJH,AAAA,iBAAA,8DAAA,3EAMQC,aAAYhC,mDAAS+B;AAN7B,AAAA,GAAA,6CAAA,IAAA,jDAQO7B,iDAAKC,gBAAM6B;AARlB,2BAAA,pBAQgCnC,oBAAYoC,gBAAMD;;AARlD,AAAA,IAAAH,aAU0BG;YAV1B,AAAA3B,4CAAAwB,WAAA,IAAA,nEAUaK;YAVb,AAAA7B,4CAAAwB,WAAA,IAAA,nEAUmBM;cAVnB,VAWYC,UAASvC,oBAAWqC;cAXhC,VAYYG,UAASxC,oBAAWsC;AAZhC,AAAA,GAAA,YAAA,XAakBC;AACRC;;AACAD;;;;;AAEV,mDAAA,QAAA,3DAACpC","names":["app.time/parse-date","date-string","split","clojure.string.split","clojure.string/trim","cljs.core._EQ_","cljs.core/count","vec__52254","cljs.core.nth","month","day","year","G__52257","p__52258","map__52259","cljs.core/--destructure-map","cljs.core.get","app.time/map-to-timestamp","date","cljs-time.coerce/to-long","cljs_time.core.date_time","cljs.spec.alpha/def-impl","cljs.core/string?","app.time/Date","cljs.spec.alpha/and-spec-impl","cljs.core/int?","cljs.core/pos?","app.time/Timestamp","spec_tools.data_spec.spec","cljs.spec.alpha/fspec-impl","cljs.spec.alpha.spec_impl","cljs.spec.alpha/cat-impl","vec__52261","app.time/parse-date-range","date-range","split-date","cljs.core/first","date1","date2","parsed1","parsed2"],"sourcesContent":["(ns app.time\n  (:require\n    [cljs-time.core :refer [date-time]]\n    [cljs-time.coerce :refer [to-long]]\n    [clojure.string :as st]\n    [ghostwheel.core :as g :refer [>defn >defn- >fdef => | <- ?]]\n    [cljs.spec.alpha :as s]\n    [spec-tools.data-spec :as ds]))\n\n\n(defn parse-date\n  [date-string]\n  (let [split (st/split (st/trim date-string) \"/\")]\n    (if (not (= 3 (count split)))\n      nil\n      (let [[month day year] split]\n        {:month (int month)\n         :date (int day)\n         :year (int (case (count year)\n                       2 (str \"20\" year)\n                       4 year\n                       nil))}))))\n\n(defn map-to-timestamp\n  [{:keys [month date year]}]\n  (to-long (date-time year month date)))\n\n(s/def ::date string?)\n(def Date :string)\n\n(s/def ::timestamp (s/and int? pos?))\n(def Timestamp [:and :int [:>= 0]])\n\n\n; Outputs dates in format https://vega.github.io/vega-lite/docs/datetime.html\n(s/def ::vega-date\n  (ds/spec ::vega-date {:month int?\n                        :date int?\n                        :year int?}))\n\n(>defn parse-date-range\n  \"Converts a range like '1/1/2021 to 2/1/2021' into a single date. Will return\n  the first date unless it is unparsable, in which case will return the second.\n  If no 'to' is in the string, will just return the only date (if it is one).\"\n  [date-range]\n  [::date => ::vega-date]\n  (let [split-date (st/split date-range \" to \")]\n    (cond\n      (= 1 (count split-date)) (parse-date (first split-date))\n      :else\n      (let [[date1 date2] split-date \n            parsed1 (parse-date date1)\n            parsed2 (parse-date date2)]\n        (if (nil? parsed1)\n          parsed2\n          parsed1)))))\n\n(st/split \"4/4/4\" \" to \")\n"]}